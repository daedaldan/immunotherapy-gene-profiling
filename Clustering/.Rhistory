packageVersion("DESeq2")
c("hello", "there", "mate")
factor(("hello", "there", "mate"))
factor(c("hello", "there", "mate"))
library(DESeq2)
setwd("/Users/danielwang/Documents/immunotherapy-gene-profiling/Clustering")
library("DESeq2")
countData <- as.matrix(read.csv("one_added_raw_counts.csv", row.names="gene_id"))
countData
condition <- c('nonresponse', 'response', 'response', 'response', 'response', 'nonresponse', 'response', 'response', 'nonresponse', 'nonresponse', 'response', 'nonresponse', 'response', 'response', 'nonresponse', 'nonresponse', 'nonresponse', 'nonresponse', 'response', 'response', 'response', 'nonresponse', 'nonresponse', 'nonresponse', 'response', 'response', 'response')
sample_info <- data.frame(condition = condition, row.names = colfnames(countData))
sample_info <- data.frame(condition = condition, row.names = colnames(countData))
subset(countData, select=-c('X'))
subset(countData, select=-c(X))
countData = subset(countData, select=-c(X))
sample_info <- data.frame(condition = condition, row.names = colnames(countData))
sample_info
dataset = DESeqDataSetFromMatrix(condition = condition, row.names = colnames(countData))
dataset = DESeqDataSetFromMatrix(countData = countData, colData = sample_info, design = ~condition)
counts(dataset)
library("data.table")
countData = setDT(as.data.frame.matrix(countData), keep.rownames = "ENSEMBL ID")[]
write.table(countData, file="one_added_raw_counts.txt", sep = "\t", quote = FALSE, row.names = FALSE)
