packageVersion("DESeq2")
c("hello", "there", "mate")
factor(("hello", "there", "mate"))
factor(c("hello", "there", "mate"))
library(DESeq2)
condition <- c('nonresponse', 'response', 'response', 'response', 'response', 'nonresponse', 'response', 'response', 'nonresponse', 'nonresponse', 'response', 'nonresponse', 'response', 'response', 'nonresponse', 'nonresponse', 'nonresponse', 'nonresponse', 'response', 'response', 'response', 'nonresponse', 'nonresponse', 'nonresponse', 'response', 'response', 'response')
setwd("users/danielwang/documents/immunotherapy-gene-profiling")
q()
setwd("Users/danielwang/Documents/Gene Set Enrichment Analysis")
setwd("Users/danielwang/Documents")
getwd()
setwd("Documents")
setwd("immunotherapy-gene-profiling")
countData <- as.matrix(read.csv(“Gene Set Enrichment Analysis/raw_counts.csv”, row.names="gene_id"))
countData <- as.matrix(read.csv("Gene Set Enrichment Analysis/raw_counts.csv", row.names="gene_id"))
countData <- estimateSizeFactors(countData)
library("DESeq2")
countData <- estimateSizeFactors(countData)
countData <- estimateSizeFactors(data.frame(countData))
countData
countData <- DESeq2::estimateSizeFactors(data.frame(countData))
estimateSizeFactors(countData)
condition <- c('nonresponse', 'response', 'response', 'response', 'response', 'nonresponse', 'response', 'response', 'nonresponse', 'nonresponse', 'response', 'nonresponse', 'response', 'response', 'nonresponse', 'nonresponse', 'nonresponse', 'nonresponse', 'response', 'response', 'response', 'nonresponse', 'nonresponse', 'nonresponse', 'response', 'response', 'response')
sample_info <- data.frame(condition = condition, row.names = colnames(countData))
sample_info
dataset = DESeqDataSetFromMatrix(countData = countData, colData = sample_info, design = ~condition)
dataset
colData(dataset)
counts(dataset)
dataset <- estimateSizeFactors(dataset)
dataset
sizeFactors(dataset)
colData(dataset)
normalized_counts <- counts(dataset, normalized = TRUE)
normalized_counts
descriptions <- rep(NA, 416)
normalized_counts <- cbind(“DESCRIPTION” = descriptions, normalized_counts)
normalized_counts <- cbind("DESCRIPTION" = descriptions, normalized_counts)
normalized_counts
len(normalized_counts)
length(normalized_counts)
normalized_counts <- counts(dataset, normalized = TRUE)
length(normalized_counts)
descriptions <- rep(NA, 1379511)
normalized_counts <- cbind("DESCRIPTION" = descriptions, normalized_counts)
dataset
normalized_counts <- 5
normalized_counts <- counts(dataset, normalized = TRUE)
length(normalized_counts)
descriptions <- rep(NA, 1379511)
sum(is.na(descriptions))
length(row.names(normalized_counts))
descriptions <- rep(NA, 51093)
length(row.names(normalized_counts)) == length(descriptions)
normalized_counts <- cbind(“DESCRIPTION” = descriptions, normalized_counts)
normalized_counts <- cbind("DESCRIPTION" = descriptions, normalized_counts)
normalized_counts <- cbind(“NAME” = rownames(normalized_counts), normalized_counts)
normalized_counts <- cbind("NAME" = rownames(normalized_counts), normalized_counts)
normalized_counts
write.table(normalized_counts, file="Gene Set Enrichment Analysis/GSEA_formatted_normalized_counts.txt", sep = "\t", quote = FALSE, row.names = FALSE)
