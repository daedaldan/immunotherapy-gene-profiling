packageVersion("DESeq2")
c("hello", "there", "mate")
factor(("hello", "there", "mate"))
factor(c("hello", "there", "mate"))
library(DESeq2)
condition <- c('nonresponse', 'response', 'response', 'response', 'response', 'nonresponse', 'response', 'response', 'nonresponse', 'nonresponse', 'response', 'nonresponse', 'response', 'response', 'nonresponse', 'nonresponse', 'nonresponse', 'nonresponse', 'response', 'response', 'response', 'nonresponse', 'nonresponse', 'nonresponse', 'response', 'response', 'response')
setwd("users/danielwang/documents/immunotherapy-gene-profiling")
q()
library("EnsDb.Hsapiens.v79")
keytypes("EnsDb.Hsapiens.v79")
keytypes(EnsDb.Hsapiens.v79)
setwd("/Users/danielwang/documents/immunotherapy-gene-profiling")
genes <- read.delim("Differential Expression Analysis/DGEgenes.txt", header = TRUE, sep = "\t")
genes
results <- read.delim("Differential Expression Analysis/results.txt", header = TRUE, sep = "\t")
results
results <- results[order(results$padj), ]
results
results <- subset(sorted_results, padj < 0.05)
results <- subset(results, padj < 0.05)
results
library("EnsDb.Hsapiens.v79")
symbols <- ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("SYMBOL"), multivals= "first")
symbols
descriptions <- ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = rownames(results), keytype = "GENEID", column = c("GENENAME"), multivals= "first")
descriptionsdescriptions <- ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("GENENAME"), multivals= "first")da
descriptions <- ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("GENENAME"), multivals= "first")
descriptios
descriptions
keytypes(EnsDb.Hsapiens.v79)
ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("GENENAME"), multivals= "first")
ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("SEQNAME"), multivals= "first")
ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("PROTEINID"), multivals= "first")
ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("EXONID"), multivals= "first")
ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("GENEBIOTYPE"), multivals= "first")
ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("TXBIOTYPE"), multivals= "first")
ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("TXNAME"), multivals= "first")
ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("PROTEINDOMAINSOURCE"), multivals= "first")
keytypes(EnsDb.Hsapiens.v79)
ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("SEQSTRAND"), multivals= "first")
library("biomaRt")
mart <- useDataset("hsapiens_gene_ensembl", useMart("ensembl"))
keytypes(biomaRt)
getBM(filters = "ensembl_gene_id", attributes = c("ensembl_gene_id", "hgnc_symbol"), values = results$gene_id, mart = mart)
keytypes(mart)
getBM(filters = "ensembl_gene_id", attributes = c("ensembl_gene_id", "description"), values = results$gene_id, mart = mart)
descriptions <- getBM(filters = "ensembl_gene_id", attributes = c("ensembl_gene_id", "description"), values = results$gene_id, mart = mart)
results
results[2:]
results[, 2:]
results[, 2:5]
results[, 2:7]
results <- cbind("gene_id" = results$gene_id, "hgnc_symbol" = symbols, "description" = descriptions, results[, 2:7])
results
results <- read.delim("Differential Expression Analysis/results.txt", header = TRUE, sep = "\t")
results <- results[order(results$padj), ]
results <- subset(results, padj < 0.05)
results
results <- cbind("gene_id" = results$gene_id, "hgnc_symbol" = symbols, "description" = descriptions, results[, 2:7])
results
descriptions
results <- read.delim("Differential Expression Analysis/results.txt", header = TRUE, sep = "\t")
results <- subset(results, padj < 0.05)
results <- cbind("gene_id" = results$gene_id, "hgnc_symbol" = symbols, "description" = descriptions.description, results[, 2:7])
descriptions
descriptions$description
results <- cbind("gene_id" = results$gene_id, "hgnc_symbol" = symbols, "description" = descriptions$description, results[, 2:7])
results
results <- data.frame(results)
results
rownames(results) <- NULL
results
results <- read.delim("Differential Expression Analysis/results.txt", header = TRUE, sep = "\t")
results <- results[order(results$padj), ]
results <- subset(results, padj < 0.05)
symbols <- ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("SYMBOL"), multivals= "first")
symbols
descriptions <- getBM(filters = "ensembl_gene_id", attributes = c("ensembl_gene_id", "description"), values = results$gene_id, mart = mart)
descriptions
results <- cbind("gene_id" = results$gene_id, results[, 2:7], "hgnc_symbol" = symbols, "description" = descriptions$description)
rownames(results) <- NULL
results
results <- cbind("gene_id" = results$gene_id, "log2FoldChange" = results$log2FoldChange, "padj" = results$padj, "hgnc_symbol" = symbols, "description" = descriptions$description)
results
rownames(results) <- NULL
results
results
results <- results[order(results$log2FoldChange, descending = TRUE), ]
results <- read.delim("Differential Expression Analysis/results.txt", header = TRUE, sep = "\t")
results <- results[order(results$padj), ]
results <- subset(results, padj < 0.05)
symbols <- ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("SYMBOL"), multivals= "first")
descriptions <- getBM(filters = "ensembl_gene_id", attributes = c("ensembl_gene_id", "description"), values = results$gene_id, mart = mart)
results <- cbind("gene_id" = results$gene_id, "log2FoldChange" = results$log2FoldChange, "padj" = results$padj, "hgnc_symbol" = symbols, "description" = descriptions$description)
rownames(results) <- NULL
results <- results[order(results$log2FoldChange, descending = TRUE), ]
results <- results[order(results['log2FoldChange'], descending = TRUE), ]
results
results <- read.delim("Differential Expression Analysis/results.txt", header = TRUE, sep = "\t")
results <- subset(results, padj < 0.05)
symbols <- ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("SYMBOL"), multivals= "first")
descriptions <- getBM(filters = "ensembl_gene_id", attributes = c("ensembl_gene_id", "description"), values = results$gene_id, mart = mart)
results <- cbind("gene_id" = results$gene_id, "log2FoldChange" = results$log2FoldChange, "padj" = results$padj, "hgnc_symbol" = symbols, "description" = descriptions$description)
rownames(results) <- NULL
results
old_results <- results
results <- results[order(results['log2FoldChange'], decreasing = TRUE), ]
results
results <- data.frame(old_results)
results
results <- results[order(results['log2FoldChange'], decreasing = TRUE), ]
results
write.csv(results, "DGE_genes_results.csv")
library("org.Hs.eg.db")
hugo <- mapIds(org.Hs.eg.db, keys=countData$ENSEMBL.ID, column="SYMBOL", keytype="ENSEMBL", multivals="first")
keytypes(org.Hs.eg.db)
results <- read.delim("Differential Expression Analysis/results.txt", header = TRUE, sep = "\t")
results <- subset(results, padj < 0.05)
library("EnsDb.Hsapiens.v79")
symbols <- ensembldb::mapIds(EnsDb.Hsapiens.v79, keys = results$gene_id, keytype = "GENEID", column = c("SYMBOL"), multivals= "first")
descriptions <- mapIds(org.Hs.eg.db, keys=results$gene_id, column="GENENAME", keytype="ENSEMBL", multivals="first")
descriptions
results <- cbind("gene_id" = results$gene_id, "log2FoldChange" = results$log2FoldChange, "padj" = results$padj, "hgnc_symbol" = symbols, "description" = descriptions)
results
rownames(results) <- NULL
results <- data.frame(results)
results
results <- results[order(results['log2FoldChange'], decreasing = TRUE), ]
results
write.csv(results, "DGE_genes_results.csv")
sum(results$log2FoldChange > 0)
sum(results$log2FoldChange < 0)
